!function(a){"function"==typeof define&&define.amd?define(["zepto"],a):a(Zepto)}(function(a){"use strict";var e,i=function(e,t){this.options=a.extend({},i.defaults,t),this.$element=a(e),this.init()};i.pluginName="keyboard",i.dataName="keyboard",i.version="2.0.0",i.defaults={length:7,text:{normal:"普通车牌录入",energy:"新能源车牌录入"},title:"添加车牌",buttonText:"添加",isAddColor:!1,isAutoFill:!0,beforeOpenFn:null,confirmCallback:null,hiddenCallback:null},i.prototype={init:function(){var i=this;0===a("#keyboard_wrapper").length&&e._initKbHtml(),this.$element.off("click").on("click",function(){var e=!0;a(this).blur(),i.options.beforeOpenFn&&(e=i.options.beforeOpenFn()),e&&i.initShowEvt()})},initShowEvt:function(i,t){var s=this.options,l=s.license;i=e._getVal(this.$element,l),t=s.length;var o=s.title,r=s.buttonText;a("#header_title").text(o),a("#kb_confirm").text(r),this.changePlate(t),this.fillPlate(i,t),this.setConfirmBtn(),this.showKeyboard(),this.setMargin(),this.bindClickPanelEvts()},showKeyboard:function(){var e=a("#keyboard_wrapper");e.hasClass("toggle")||e.addClass("toggle")},hideKeyboard:function(){var e=a("#keyboard_wrapper"),i=a('input[name="plate-color"]:checked').val();e.hasClass("toggle")&&e.removeClass("toggle"),7===a("#plate_type_title").data("turn-type")?this.$element.data("color",""):this.$element.data("color",i),e.find(".kb-item").removeAttr("style"),this.options.hiddenCallback&&this.options.hiddenCallback(this.getLicense())},getLicense:function(e){var i=a("#plate_box").find(".plate-item:not(.ake-hide)"),t="",s=a('input[name="plate-color"]:checked').val();return i.each(function(){var e=a(this).text();return!!e&&void(t+=e)}),e?t.length:this.options.isAddColor?t+s:t},changePlate:function(e){var i=a("#keyboard_wrapper #plate_box"),t=a("#plate_type_title"),s=this.options.text.normal,l=this.options.text.energy;7==e?(i.removeClass("has-eight-item"),i.find(".eighth-item").text("").addClass("ake-hide"),t.text(l+">>").data("turn-type",8),a(".blue-plate-box").show()):8==e&&(i.addClass("has-eight-item"),i.find(".eighth-item").text("").removeClass("ake-hide"),t.text(s+">>").data("turn-type",7),a(".blue-plate-box").hide())},fillPlate:function(e,i){var t=a("#keyboard_wrapper #plate_box").find(".plate-item"),s=0;if(t.text(""),e){var l=e.split("");a.each(l,function(a,e){t.eq(a).text(e),s=a}),s=s+1<i?s+1:i-1}t.eq(s).addClass("active").siblings().removeClass("active"),this.togglePanel(s)},setMargin:function(){var e=a("#keyboard_box"),i=e.find(".operate-list").find(".kb-item").eq(0),t=a(window).width()-2*Number(e.css("padding-left").replace(/px/,"")),s=i.width(),l=s+2*Number(i.css("margin-left").replace(/px/,"")),o=0,r=0;o=Math.floor(t/l),r=(t/o-s)/2,e.find(".kb-item").css({"margin-left":r,"margin-right":r})},togglePanel:function(e){function i(){l.indexOf("粤Z")>-1?(t.eq(1).find(".last-item").hide(),t.eq(1).find(".hk-macao-item").show()):(t.eq(1).find(".last-item").show(),t.eq(1).find(".hk-macao-item").hide())}var t=a("#keyboard_box").find("li:not(.operate-list)"),s=this.options.length,l=this.getLicense();switch(t.eq(2).find(".not-pos-two").removeClass("ake-hide"),e){case 0:t.addClass("ake-hide"),t.eq(0).removeClass("ake-hide");break;case 1:t.addClass("ake-hide"),t.eq(2).removeClass("ake-hide"),t.eq(1).find(".last-item,.not-pos-two").addClass("ake-hide");break;case 2:case 3:case 4:case 5:t.addClass("ake-hide"),t.eq(1).removeClass("ake-hide"),t.eq(2).removeClass("ake-hide"),t.eq(1).find(".last-item").addClass("ake-hide");break;case 6:t.addClass("ake-hide"),t.eq(1).removeClass("ake-hide"),t.eq(2).removeClass("ake-hide"),7==s?(t.eq(1).find(".last-item").removeClass("ake-hide"),i()):t.eq(1).find(".last-item").addClass("ake-hide");break;case 7:if(7==s)break;t.addClass("ake-hide"),t.eq(1).removeClass("ake-hide"),t.eq(2).removeClass("ake-hide"),t.eq(1).find(".last-item").removeClass("ake-hide"),i();break;default:t.addClass("ake-hide"),t.eq(0).removeClass("ake-hide")}},deleteOneEvts:function(e){var i=a("#plate_box").find(".plate-item"),t=this.getLicense(1),s=t;e?(i.each(function(){a(this).text("")}),i.eq(0).addClass("active").siblings().removeClass("active"),s=0):t>0?(i.eq(t-1).text("").addClass("active").siblings().removeClass("active"),s--):(i.eq(0).addClass("active").siblings().removeClass("active"),s=0),this.togglePanel(s)},setConfirmBtn:function(){var e=this.options.length,i=this.getLicense(1);i==e?a("#kb_confirm").removeClass("hide"):a("#kb_confirm").addClass("hide")},bindClickPanelEvts:function(){var i=this;a("#keyboard_wrapper #close_keyboard").off().on("click",function(a){i.hideKeyboard()}),a("#plate_box .plate-item").off().on("click",function(e){e.stopPropagation();var t=a(this),s=t.text(),l=t.index(),o=a("#plate_box").find(".active");if(s)l!=o&&(t.addClass("active").siblings().removeClass("active"),i.togglePanel(l));else{var r=i.getLicense(1);a("#plate_box .plate-item").eq(r).addClass("active").siblings().removeClass("active"),i.togglePanel(r)}}),a("#keyboard_box .kb-item").off().on("click",function(e){if(e.stopPropagation(),!a(this).hasClass("placehold-item")){a("#keyboard_box .kb-item").removeClass("active");var t=a(this),s=a("#plate_box").find(".plate-item"),l=(i.getLicense(1),i.options.length);if(t.hasClass("clear-all"))i.deleteOneEvts(1),i.setConfirmBtn();else if(t.hasClass("delete-one"))i.deleteOneEvts(),i.setConfirmBtn();else{t.addClass("active");var o=t.text(),r=a("#plate_box").find(".active").index(),c=r;t.hasClass("change-to-num")&&r>1&&(o="O"===o?"0":"1"),s.eq(r).text(o),r+1<l&&(s.eq(r+1).addClass("active").siblings().removeClass("active"),r++),r!=c&&i.togglePanel(r),i.setConfirmBtn(),setTimeout(function(){t.removeClass("active")},100)}}}),a("#plate_type_title").off().on("click",function(e){e.stopPropagation();var t=Number(a(this).data("turn-type")),s=0;i.options.length=t,i.changePlate(t),i.fillPlate(""),i.togglePanel(s),i.setConfirmBtn(),a("#plate_box .plate-item").eq(s).addClass("active").siblings().removeClass("active")}),a("#kb_confirm").off().on("click",function(a){a.stopPropagation(),i.options.isAutoFill&&e._setVal(i.$element,i.getLicense()),i.options.confirmCallback&&i.options.confirmCallback(i.getLicense()),i.hideKeyboard()})}},e=function(){function e(){var a='<link rel="stylesheet" href="dist/css/keyboard.min.css">',e='<div id="keyboard_wrapper" class="keyboard-wrapper">        <div class="keyboard-header">          <h3 id="header_title" class="header-title">添加车牌</h3>          <a id="close_keyboard" class="close">&times;</a>          <a id="kb_confirm" class="add-btn">添加</a>        </div>        <div class="plate-wrapper">          <div id="plate_box" class="plate-box">            <span class="plate-item"></span>            <span class="plate-item"></span>            <span class="plate-item"></span>            <span class="plate-item"></span>            <span class="plate-item"></span>            <span class="plate-item"></span>            <span class="plate-item"></span>            <span class="plate-item eighth-item"></span>          </div>          <div class="plate-setting">            <div class="blue-plate-box clearfix"><div class="iradio-box blue">                <input type="radio" name="plate-color" id="blue" class="iradio" value="蓝" checked><i class="icon"></i>                <label class="iradio-text blue" for="blue">蓝牌</label>              </div>              <div class="iradio-box yellow">                <input type="radio" name="plate-color" id="yellow" class="iradio" value="黄"><i class="icon"></i>                <label class="iradio-text yellow" for="yellow">黄牌</label>              </div>              <div class="iradio-box white">                <input type="radio" name="plate-color" id="white" class="iradio" value="白"><i class="icon"></i>                <label class="iradio-text white" for="white">白牌</label>              </div>              <div class="iradio-box black">                <input type="radio" name="plate-color" id="black" class="iradio" value="黑"><i class="icon"></i>                <label class="iradio-text black" for="black">黑牌</label>              </div>              <div class="iradio-box green">                <input type="radio" name="plate-color" id="green" class="iradio" value="绿"><i class="icon"></i>                <label class="iradio-text green" for="green">新能源</label>              </div>            </div>            <div class="plate-type-box">              <span id="plate_type_title" class="plate-type">新能源车牌录入&gt;&gt;</span>            </div>          </div>        </div>        <div class="keyboard-container">          <ul id="keyboard_box" class="keyboard-box">            <li class="keyboard-list">              <a href="javascript:void(0)" class="kb-item">京</a>              <a href="javascript:void(0)" class="kb-item">沪</a>              <a href="javascript:void(0)" class="kb-item">粤</a>              <a href="javascript:void(0)" class="kb-item">津</a>              <a href="javascript:void(0)" class="kb-item">浙</a>              <a href="javascript:void(0)" class="kb-item">苏</a>              <a href="javascript:void(0)" class="kb-item">湘</a>              <a href="javascript:void(0)" class="kb-item">渝</a>              <a href="javascript:void(0)" class="kb-item">云</a>              <a href="javascript:void(0)" class="kb-item">豫</a>              <a href="javascript:void(0)" class="kb-item">皖</a>              <a href="javascript:void(0)" class="kb-item">陕</a>              <a href="javascript:void(0)" class="kb-item">桂</a>              <a href="javascript:void(0)" class="kb-item">新</a>              <a href="javascript:void(0)" class="kb-item">青</a>              <a href="javascript:void(0)" class="kb-item">琼</a>              <a href="javascript:void(0)" class="kb-item">闽</a>              <a href="javascript:void(0)" class="kb-item">蒙</a>              <a href="javascript:void(0)" class="kb-item">辽</a>              <a href="javascript:void(0)" class="kb-item">宁</a>              <a href="javascript:void(0)" class="kb-item">鲁</a>              <a href="javascript:void(0)" class="kb-item">晋</a>              <a href="javascript:void(0)" class="kb-item">吉</a>              <a href="javascript:void(0)" class="kb-item">冀</a>              <a href="javascript:void(0)" class="kb-item">黑</a>              <a href="javascript:void(0)" class="kb-item">台</a>              <a href="javascript:void(0)" class="kb-item">甘</a>              <a href="javascript:void(0)" class="kb-item">鄂</a>              <a href="javascript:void(0)" class="kb-item">赣</a>              <a href="javascript:void(0)" class="kb-item">贵</a>              <a href="javascript:void(0)" class="kb-item">川</a>              <a href="javascript:void(0)" class="kb-item">藏</a>              <a href="javascript:void(0)" class="kb-item placehold-item"></a>              <a href="javascript:void(0)" class="kb-item placehold-item"></a>            </li>            <li class="keyboard-list ake-hide">              <a href="javascript:void(0)" class="kb-item">1</a>              <a href="javascript:void(0)" class="kb-item">2</a>              <a href="javascript:void(0)" class="kb-item">3</a>              <a href="javascript:void(0)" class="kb-item">4</a>              <a href="javascript:void(0)" class="kb-item">5</a>              <a href="javascript:void(0)" class="kb-item">6</a>              <a href="javascript:void(0)" class="kb-item">7</a>              <a href="javascript:void(0)" class="kb-item">8</a>              <a href="javascript:void(0)" class="kb-item">9</a>              <a href="javascript:void(0)" class="kb-item">0</a>              <a href="javascript:void(0)" class="kb-item last-item ake-hide">学</a>              <a href="javascript:void(0)" class="kb-item last-item ake-hide">警</a>              <a href="javascript:void(0)" class="kb-item last-item hk-macao-item ake-hide">港</a>              <a href="javascript:void(0)" class="kb-item last-item hk-macao-item ake-hide">澳</a>            </li>            <li class="keyboard-list ake-hide">              <a href="javascript:void(0)" class="kb-item">A</a>              <a href="javascript:void(0)" class="kb-item">B</a>              <a href="javascript:void(0)" class="kb-item">C</a>              <a href="javascript:void(0)" class="kb-item">D</a>              <a href="javascript:void(0)" class="kb-item">E</a>              <a href="javascript:void(0)" class="kb-item">F</a>              <a href="javascript:void(0)" class="kb-item">G</a>              <a href="javascript:void(0)" class="kb-item">H</a>              <a href="javascript:void(0)" class="kb-item not-pos-two change-to-num">I</a>              <a href="javascript:void(0)" class="kb-item">J</a>              <a href="javascript:void(0)" class="kb-item">K</a>              <a href="javascript:void(0)" class="kb-item">L</a>              <a href="javascript:void(0)" class="kb-item">M</a>              <a href="javascript:void(0)" class="kb-item">N</a>              <a href="javascript:void(0)" class="kb-item change-to-num">O</a>              <a href="javascript:void(0)" class="kb-item">P</a>              <a href="javascript:void(0)" class="kb-item">Q</a>              <a href="javascript:void(0)" class="kb-item">R</a>              <a href="javascript:void(0)" class="kb-item">S</a>              <a href="javascript:void(0)" class="kb-item">T</a>              <a href="javascript:void(0)" class="kb-item">U</a>              <a href="javascript:void(0)" class="kb-item">V</a>              <a href="javascript:void(0)" class="kb-item">W</a>              <a href="javascript:void(0)" class="kb-item">X</a>              <a href="javascript:void(0)" class="kb-item">Y</a>              <a href="javascript:void(0)" class="kb-item">Z</a>              <a href="javascript:void(0)" class="kb-item placehold-item"></a>              <a href="javascript:void(0)" class="kb-item placehold-item"></a>            </li>            <li class="keyboard-list operate-list">              <a href="javascript:void(0)" class="kb-item clear-all">重输</a>              <a href="javascript:void(0)" class="kb-item delete-one"><span class="delete-icon">&times;</span></a>            </li>          </ul>        </div>      </div>';return{css:a,html:e}}function i(){var i=e();a("html").find("head").eq(0).append(i.css),a("body").append(i.html)}function t(a){var e=a.get(0).nodeName,i=!1;return"INPUT"!=e&&"TEXTAREA"!=e||(i=!0),i}function s(a,e){var i="",s="";if(void 0==e){var l=t(a);i=l?a.val():a.text(),s=a.attr("placeholder")}else i=e;return i==s?"":i}function l(a,e){var i=t(a);i?a.val(e):a.text(e?e:a.attr("placeholder"))}return{_getTemplate:e,_initKbHtml:i,_judgeEleType:t,_getVal:s,_setVal:l}}();var t=a.fn[i.pluginName];a.fn[i.pluginName]=function(e){return this.each(function(){var t=a(this),s=a.fn[i.pluginName].kbData[t.data(i.dataName)],l="object"==typeof e&&e;s||(a.fn[i.pluginName].kbData[++a.fn[i.pluginName].kbData.index]=new i(this,l),t.data(i.dataName,a.fn[i.pluginName].kbData.index),s=a.fn[i.pluginName].kbData[t.data(i.dataName)]),"string"==typeof e&&s[e]()})},a.fn[i.pluginName].kbData={index:0},a.fn[i.pluginName].Constructor=i,a.fn[i.pluginName].noConflict=function(){return a.fn[i.pluginName]=t,this},a(document).ready(function(){a('[data-role="'+i.pluginName+'"]').each(function(){var e=a(this),t={};a.fn[i.pluginName].kbData[e.data(i.dataName)];t.length=e.data("length"),t.hiddenCallback=e.data("hiddenCallback"),a(this).data("color","blue"),a.fn[i.pluginName].call(e,t)})})});
//# sourceMappingURL=../maps/softKeyboard.min.js.map
